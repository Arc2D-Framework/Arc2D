'use strict';Session=top.Session||{State:{}};Config=window.Config||{SRC_PATH:"src/",ROOTPATH:"../../../",LOGGING:true,DYNAMICLOAD:true,FILENAME:"index.*js",ENABLE_TRANSPILER:true};var $framework={stable:"3.0.4",nightly:"3.0.4",current:"3.0.4",description:"3.0.4"};if(!String.prototype.toDomElement)String.prototype.toDomElement=function(){var n=document.createRange().createContextualFragment(this.toString());if(!n)console.error("#toDomElement() - Error parsing html",this.toString());return n.firstElementChild};
String.prototype.toLocaleString=function(langCode){langCode=langCode||Session.State.currentLanguage.CODE;var key=this.toString();if(Localization)if(Localization[langCode])return Localization[langCode][key]||Localization[langCode][key.toLowerCase()]||key;else return key;else return key};if("LOGGING"in Config&&Config.LOGGING!=true)for(var k in console)console[k]=function(){};
window.getParameterByName=function(name,url){var match=RegExp("[?&]"+name+"=([^&]*)").exec(url||window.location.href);return match&&decodeURIComponent(match[1].replace(/\+/g," "))};window.imported_classes=window.imported_classes||{};
window.imports=async function(x,opts,isError){opts=opts||{cache:Config.IMPORTS_CACHE_POLICY||"no-store"};return new Promise(async(resolve,reject)=>{var path=x;path=path.replace(/^\/+/,Config.ROOTPATH);var error="Unable to load: "+path;if(window.imported_classes[x]){console.warn("redundant imports to : "+x+" detected");resolve(window.imported_classes[x]);return}try{const response=await fetch(path,opts);if(response.ok){const res=await response.text().then((src)=>{window.imported_classes[x]=src;resolve(src)})
}else{var src=await response.text();console.error(error,src);resolve(null)}}catch(e){var request=new XMLHttpRequest;request.open("GET",path,false);request.send(null);if(request.status==0||request.status==200){src=request.responseText;window.imported_classes[x]=src;resolve(src)}}})};function transpile(target,level){}function stylesheets(target,paths){target.prototype["@stylesheets"]=paths}
function traits(target,__traits){var inheritTraits=function(klass,properties){properties=properties.reverse();properties.forEach((trait)=>{if(typeof trait=="object")defineProps(klass,trait)})};var defineProps=function(proto,trait){for(var prop in trait)if(!proto[prop])Object.defineProperty(proto,prop,{value:trait[prop],writable:true})};inheritTraits(target.prototype,__traits)}function cascade(target,shouldCascade){target.prototype["@cascade"]=shouldCascade}
function prop(target,key,val){target.prototype[key]=val}function tag(target,name){if(target.prototype["ns-tagname"])return;window.customElements.define(name,target);return}function field(target,type,key,val){target=type=="static"?target:target.prototype;target[key]=val}
(function(env){env.NSRegistry=env.NSRegistry||{};env.namespace=function(ns,def={}){var k=def.prototype||def;k.namespace=ns;k.classname=ns.match(/\.?([a-zA-Z0-9_]*)$/)[1];env.NSRegistry[ns]=createNS(ns,createClass(def||{}));return env.NSRegistry[ns]};var createNS=function(aNamespace,def){var parts=aNamespace.split(/\./g);var classname=parts.pop();var scope=parts.reduce((acc,next)=>acc[next]?acc[next]:acc[next]={},env);scope[classname]=def;return scope[classname]};var createClass=function(func){try{var proto=
func.prototype;proto.ancestor=proto.__proto__.constructor;try{func.define(proto)}catch(e){}return func}catch(e){return func}return func}})(window);namespace("core.traits.ResourcePathTransformer");
core.traits.ResourcePathTransformer={resourcepath:function(url,ns){url=url.replace(/\$\{ns\}/gm,ns.replace(/\./gim,"/"));return Config.ROOTPATH+url},relativeToAbsoluteFilePath:function(path,ns,appendRoot){ns=ns||this.namespace;ns=ns.replace(/\./gim,"/");if(path.indexOf("/./")>=0)path=path.replace("./",ns+"/");path=/http:/.test(path)?path:path.replace("//","/");return path}};
namespace("core.ui.templating.CustomTemplateEngines",class{constructor(){this.engines={};this.defaultMimetype=Config.DEFAULT_TEMPLATE_ENGINE_MIMETYPE||"template/literals"}define(mimeType,engine){if(!this.engines[mimeType]){this.engines[mimeType]=engine;engine.install()}}getEngineByMimeType(mime){return this.engines[mimeType]}get default(){return this.engines[this.defaultMimetype]}set default(mimeType){this.defaultMimetype=mimeType}});window.customTemplateEngines=new core.ui.templating.CustomTemplateEngines;
(()=>{var TemplateLiterals={name:"TemplateLiterals",ext:".es6",eval:function(tempStr,data,self){var parse=(tempStr,templateVars)=>{return(new Function("return `"+tempStr+"`;")).call(templateVars)};return parse(tempStr,data)},isAvailable:function(){return true},install:function(){console.log("TemplateLiterals template engine installed successfully.")}};window.customTemplateEngines.define("template/literals",TemplateLiterals)})();
namespace("w3c.ui.WebComponent",class extends HTMLElement{constructor(){super();this.__proto=this.constructor.prototype;this.root=this.onEnableShadow()?this.attachShadow({mode:"open"}):this}static define(proto){var tag=proto.classname.replace(/([a-zA-Z])(?=[A-Z0-9])/g,(f,m)=>`${m}-`).toLowerCase();if(/\-/.test(tag)){proto["ns-tagname"]=tag;try{window.customElements&&window.customElements.define(tag,this)}catch(e){console.error(e)}}}setStylesheet(){var css=this.cssStyle();!!css&&!this.__proto._style_defined?
(this.appendStyleSheet(`<style type="text/css" rel="stylsheet">\n${css}\n</style>`.toDomElement()),this.__proto._style_defined=true):null}querySelector(cssSel,e){if(e)return this.getParentNodeFromEvent(e,cssSel);else return this.onEnableShadow()?this.root.querySelector(cssSel):super.querySelector(cssSel)}querySelectorAll(cssSel,deep){return this.onEnableShadow()?this.root.querySelectorAll(cssSel):super.querySelectorAll(cssSel)}appendStyleSheet(stylesheet){if(this.onEnableShadow())this.root.host.appendChild(stylesheet);
else{var headNode=application.head;var configscript=application.configscript;headNode.insertBefore(stylesheet,configscript)}}adopts(orphan){orphan&&orphan.parentNode.replaceChild(this,orphan);orphan&&this.appendChild(orphan)}replaces(orphan){orphan&&orphan.parentNode.replaceChild(this,orphan)}dispatchEvent(type,data,details={bubbles:true,cancelable:true,composed:true},element=this){var evt=new CustomEvent(type,details);evt.data=data;return super.dispatchEvent(evt)}bind(el,evtName,handler){var self=
this;if(typeof el=="string")this.addEventListener(evtName,(e)=>{var t=this.getParentNodeFromEvent(e,el);if(t)handler({target:t,realtarget:e.target,src:e,preventDefault:()=>e.preventDefault,stopPropagation:()=>e.stopPropagation})},true);else el.addEventListener(evtName,handler,false)}getParentBySelectorUntil(elem,terminator="html",selector){elem=elem||this;terminator=terminator||"body";var parent_node=null;for(;elem&&elem!==document;elem=elem.parentNode){if(terminator)if(elem.matches&&elem.matches(terminator))break;
if(selector)if(elem.matches&&elem.matches(selector)){parent_node=elem;break}}return parent_node}getParentNodeFromEvent(e,selector,terminator){var el=e.composedPath()[0];return this.getParentBySelectorUntil(el,terminator,selector)}onStylesheetLoaded(style){}cssTransform(css){var ns=this.namespace;css=css.replace(/resource\(['"]?([^'"]*)['"]?\)/mg,(full,m1)=>"url("+this.resourcepath(m1,ns)+")");return css}setCssTextAttribute(_cssText,stylenode){if(stylenode&&stylenode.styleSheet)stylenode.styleSheet.cssText=
_cssText;else stylenode.appendChild(document.createTextNode(_cssText))}async loadTemplate(){return new Promise(async(resolve,reject)=>{var tem=this.querySelector("template")||this.src||this.template()||"/src/./templates/index.html";if(/\/*\.html$/.test(tem)){var src=this.src||tem;var opts={cache:"force-cache"};src=src.replace("/./","/"+this.namespace.replace(/\./gim,"/")+"/");this._template=await imports(src,opts)}else if(/<\s*\btemplate\b/.test(tem))this._template=tem;else if(tem&&tem.nodeType==
1)this._template=tem.outerHTML;resolve(this._template)})}onConnected(){}render(data){data=data||{};data.component=this;var t=this._template;if(t){var html=this.evalTemplate(t,data||{});var temNode=html.toDomElement();temNode=temNode.content;if(!this.onEnableShadow()){this.slots.forEach((slot)=>{var slotName=slot.getAttribute("slot");var placeholder=temNode.querySelector(`slot[name="${slotName}"]`);if(placeholder){placeholder.innerHTML="";placeholder.appendChild(slot)}});this.root.innerHTML=""}this.root.innerHTML=
"";this.root.appendChild(temNode);this.dispatchEvent("rendered")}}static get observedAttributes(){return["src"]}get src(){return this.getAttribute("src")}set src(val){this.setAttribute("src",val)}onEnableShadow(){return this.getAttribute("attach-shadow")!="false"}attachShadow(options){this._usesShadow=true;return super.attachShadow(options)}async attributeChangedCallback(name,oldValue,newValue){if(name=="src")if(!this._is_connected)return;else{var html=await this.loadTemplate();this.onConnected()}}async connectedCallback(){if(this._is_connected)return;
this._is_connected=true;var html=await this.loadTemplate();this.onTemplateLoaded()}onTemplateLoaded(){this.slots=this.getSlots();this.setClassList();this.setPrototypeInstance();this.setStyleDocuments();this.onConnected();this.dispatchEvent("connected")}getSlots(){var nodes=[];this.childNodes.forEach((node)=>{node.nodeType==1&&node.getAttribute("slot")&&nodes.push(node)});return nodes}cssStyle(){return""}setStyleDocuments(){this.loadcss(this.getStyleSheets());this.setStylesheet()}getStyleSheets(){var ancestor=
this.ancestor;var classes=[];var ancestors=[];var stylesheets=[];if(this["@cascade"])while(ancestor){var p=ancestor.prototype;var styles=p["@stylesheets"]||[];ancestors.unshift(ancestor);for(var i=0;i<=styles.length-1;i++)stylesheets.push(this.relativeToAbsoluteFilePath(styles[i],p.namespace,false));ancestor=p["@cascade"]?p.ancestor:null}var this_styles=this["@stylesheets"]||[];for(var i=0;i<=this_styles.length-1;i++)stylesheets.unshift(this.relativeToAbsoluteFilePath(this_styles[i],this.namespace,
false));return stylesheets}async loadcss(url){var self=this;var stylesheets=window.loaded_stylesheets=window.loaded_stylesheets||{};if(stylesheets[url]){self.onStylesheetLoaded(stylesheets[url]);return}var styles=url||this["@stylesheets"];if(styles)if(styles instanceof Array){styles=styles.reverse();styles.forEach((path)=>this.loadcss(path))}else if(typeof styles==="string"){var path=styles;var tagName=/^http/.test(path)?"link":"style";var tag=document.createElement(tagName);tag.setAttribute("type",
"text/css");tag.setAttribute("rel","stylesheet");tag.setAttribute("href",path);tag.setAttribute("component",this.namespace);this.appendStyleSheet(tag);stylesheets[path]=tag;if(tagName=="style"){var _cssText=await window.imports(path);_cssText=self.cssTransform(_cssText);self.setCssTextAttribute(_cssText,tag);self.onStylesheetLoaded(tag)}}else try{console.warn("Unable to resolve path to stylesheet. Invalid uri: '"+styles+"'")}catch(e){}else;}template(){return null}evalTemplate(template,data){var eng=
this.getTemplateEngine();return eng.eval(template,data,this)}getTemplateEngine(){return window.customTemplateEngines.default}setPrototypeInstance(){this.setAttribute("namespace",this.namespace);this.prototype=this}setClassList(){var classes=[];if(this["@cascade"]==true){var ancestor=this.ancestor;while(ancestor&&ancestor.prototype["@cascade"]==true){var proto=ancestor.prototype;classes.unshift(proto.classname);ancestor=proto.ancestor;if(!ancestor||ancestor==HTMLElement)break}}classes.push(this.classname);
var newClsName=this.className+(" "+classes.join(" "));this.className=newClsName.trim()}});transpile(w3c.ui.WebComponent,"es7");traits(w3c.ui.WebComponent,[core.traits.ResourcePathTransformer]);
(()=>{w3c.ui.WebComponent.prototype.getParentBySelectorUntil=function(elem=this,terminator="html",selector){var parent_node=null;do{if(elem.matches(selector)){parent_node=elem;break}if(elem.matches(terminator))break;elem=elem.parentNode}while(elem);return parent_node};w3c.ui.WebComponent.prototype.bind=function(el,evtName,handler,bool=false){var self=this;if(typeof el=="string")this.addEventListener(evtName,(e)=>{var t=this.getParentNodeFromEvent(e,el);if(t)handler({target:t,realtarget:e.target,src:e,
preventDefault:()=>e.preventDefault,stopPropagation:()=>e.stopPropagation})},bool);else el.addEventListener(evtName,handler,bool)};w3c.ui.WebComponent.prototype.getRealTargetFromEvent=function(e,selector,terminator){console.warn(`DEPRECATED: ${this.namespace}.getRealTargetFromEvent() - use getParentNodeFromEvent()`,arguments.callee);return this.getParentNodeFromEvent(e,selector,terminator)}})();
namespace("w3c.ui.Application",class extends w3c.ui.WebComponent{constructor(element){super(element);window.application=this;this.head=document.getElementsByTagName("head")[0];this.configscript=document.querySelector("script[id='config']")||document.querySelector("script")}template(){return""}});function Ecmascript6ClassTranspiler(){}Ecmascript6ClassTranspiler.prototype.imports=window.imports;
Ecmascript6ClassTranspiler.prototype.transpile=function(src,doc){var doTranspile=Config.ENABLE_TRANSPILER;if(doTranspile){src=this.transpileToLevel(src);return src}else return src};
Ecmascript6ClassTranspiler.prototype.transpileToLevel=function(src){var nsReg=/(?:@{1}[^\s]*\({1}[^;]*\){1};{1})?\n?namespace\(['"]{1}([^'"]*)/;var nsMatch=src.match(nsReg);nsMatch=nsMatch?nsMatch[1]:"";src=this.transipleDecoratorFields(nsMatch,src);src=this.transipleClassFields(nsMatch,src);src=this.transipleImportsDestructuring(nsMatch,src);return src};
Ecmascript6ClassTranspiler.prototype.transipleDecoratorFields=function(ns,src){var regex=/@([^\W]*)\({1}([^;]*)\){1};{1}/gm;var props=[];if(ns){src=src.replace(regex,(full,method,args)=>{props.push(`${method}(${ns}, ${args});`);return""});var fullsrc=src+"\n"+props.join("\n")}else{src=src.replace(regex,(full,method,args)=>{return""});fullsrc=src}return fullsrc};
Ecmascript6ClassTranspiler.prototype.transipleImportsDestructuring=function(ns,src){var regex=/import\s\{([^\}]*)\}\sfrom\s([^;]*)/gm;src=src.replace(regex,(full,destructured_var,src_path)=>{destructured_var=destructured_var.replace(/\s+as\s+/gm,":");return`const {${destructured_var}} = (()=> {\nimport ${src_path};\n})();`});src=src.replace("export","return");return src};
Ecmascript6ClassTranspiler.prototype.transipleClassFields=function(ns,src){var regex=new RegExp(/(@static|@public|@private)\s+([^\s]*)\s+=([^;]*);/gm);var props=[];if(ns){src=src.replace(regex,(full,type,name,val)=>{type=type.replace("@","");props.push(`field(${ns}, "${type}", "${name}", ${val});`);return""});var fullsrc=src+"\n"+props.join("\n")}else{src=src.replace(regex,(full,type,name,val)=>{return""});fullsrc=src}return fullsrc};
Ecmascript6ClassTranspiler.prototype.Build=async function(_code,cb){_code=this.transpile(_code);var self=this;var finished=false;var reg=/^(?:\/\/=\s*require|import\W|#+include\W)\s*['"]{1}([^'"]*)['"]{1};/im;while(reg.test(_code)){var s="";var ns_or_path=_code.match(reg)[1];if(/\.js|\.mjs$/.test(ns_or_path)){if(/\.mjs$/.test(ns_or_path))_code=`(()=>{ ${_code} })()`;if(window.imported_classes[ns_or_path])s=/\.mjs$/.test(ns_or_path)?window.imported_classes[ns_or_path]:";";else s=await this.imports(ns_or_path)}s=
s?this.transpile(s):"";_code=_code.replace(reg,s)}cb(_code)};namespace("core.http.ResourceLoader",class{constructor(){return this}});
namespace("core.http.ClassLoader",class extends core.http.ResourceLoader{constructor(){super();return this}async load(_namespace,filepath,cb){var es6Transpiler=new Ecmascript6ClassTranspiler;var self=this;var src;var cbSuccess=function(src){es6Transpiler.Build(src,(output)=>{var head=document.getElementsByTagName("head").item(0);var script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("charset",Config.CHARSET||"utf-8");script.text=output;head.appendChild(script);
if(NSRegistry[_namespace]){var data={Class:NSRegistry[_namespace],source:output,path:filepath};cb?cb(data):null}else console.error("core.http.ClassLoader#cbSuccess() - Problem while checking loaded namespace: ",[_namespace,filepath,output])})};var cfFailure=function(src,xhr){cb?cb(xhr):null};var src;if(filepath)src=await es6Transpiler.imports(filepath);else{var paths_to_try=es6Transpiler.pathsToTry(_namespace);src=await es6Transpiler.imports(paths_to_try[0],false)||await es6Transpiler.imports(paths_to_try[1],
false)}src?cbSuccess(src):cfFailure(src,"no xhr")}});namespace("core.http.ModuleLoader",class extends core.http.ResourceLoader{constructor(){super();return this}load(ns,filepath,cb){var head=document.getElementsByTagName("head").item(0);var script=document.createElement("script");script.setAttribute("type","module");script.setAttribute("charset",Config.CHARSET||"utf-8");script.src=filepath;head.appendChild(script);var data={};cb?cb(script):null}});
document.addEventListener("DOMContentLoaded",()=>{function bootup(){var ns=Config.NAMESPACE||resolveNs();if(Config.DYNAMICLOAD){var filename_path=Config.SRC_PATH+ns.replace(/\./g,"/")+"/"+Config.FILENAME;var path=filename_path.replace("*",Config.USE_COMPRESSED_BUILD?"min.":"");var c=Config.ENABLE_TRANSPILER?new core.http.ClassLoader:new core.http.ModuleLoader;c.load(ns,Config.ROOTPATH+path,(data)=>init(ns))}else init(ns)}function resolveNs(){var nsPath=location.href.split(Config.SRC_PATH)[1];var parts=
nsPath.split("/");return`${parts[0]}.${parts[1]}`}function init(ns){var ac=NSRegistry[ns];/\bApplicationContainer\b/.test(ns)&&ac?new ac(document):void null}"cordova"in window?document.addEventListener("deviceready",bootup,false):bootup()},false);
