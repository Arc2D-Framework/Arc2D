<template>
  <div>

    
    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Building a Toggle Button (continued)</h1>
        <p>
            A toggle button can be created in a few ways, here I'll give you the
            HTML, JavaScript and CSS snippets (to the right) and leave you to
            read the code as an exercise for following along and 
            understanding the gist of it, at a broad level for now.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <blockquote class="javascript" style="display:block;width: 100%;">
                Let's begin by opening the Class that was generated earlier
            </blockquote>
            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
namespace \`core.ui\` (
    class ToggleButton extends WebComponent {
        async onConnected(){
            await super.onConnected();
        }
    }
)
                </code>
            </pre>
        </div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>

    




    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">When onConnected()</h1>
        <p>
            As you'll eventually discover in the chapter, <a href="#docs.topics.ComponentLifecycle">Component Lifecycle</a>, WebComponents move through a series of states as the Arc Engine discovers and connects each component on the web page.
        </p>
        <p>
            <code>onConnected()</code> is the wiring junction-box of web components. It is in here you'll query the component tree -- the <strong>childNodes</strong> of this component. It is here where logic resides, regarding mutations and/or manipulations to the childNodes (see html template tab). 
        </p>
        <h3>What trips off onConnected()?</h3>
        <p>
            <code>onConnected()</code> is auto-fired by the Arc Engine when the component becomes connected to the web page. What does this mean? Simply put, when a component is appended as a child to the page, and/or used as a tag in the HTML, it trips the <code>onConnected()</code> method of the component instance instantly and only once for that component.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <blockquote class="javascript" style="display:block;width: 100%;">
                <code style="display:inline;">onConnected()</code> is only invoked by the Arc Engine when it detects
                physical usage (placement) of the component on a page. You'll never call this method yourself or from other
                components.
            </blockquote>
            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
async onConnected(){
    await super.onConnected();
}
                </code>
            </pre>
        </div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>








    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">ToggleButton HTML</h1>
        <p>
            Open the components html template (index.html file) and enter the HTML shown on the right under <strong>HTML tab</strong>. We'll shoot for clean, supple HTML. We need just a single div at minimum for the .knob. The template itself is wrapped within another parent div when rendered, holding the dom-tree together -- which can be styled as a container, as you'll see in the CSS section.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang">
            <blockquote class="html" style="display:block;width: 100%;">
                What our toggle needs is a Knob to indicate direction (on | off) and serve as an element to press or tap on. All we need is a simple &#x3C;div&#x3E; that will be styled into a circular shape using CSS.
            </blockquote>
            <pre class="highlight html" style="display:block;width: 100%;">
                <code id="ns-code-block">
&#x3C;template&#x3E;
    &#x3C;div class=&#x22;knob&#x22;&#x3E;&#x3C;/div&#x3E;
&#x3C;/template&#x3E;
                </code>
            </pre>
        </div>
        <div class="css lang"></div>
      </div>
    </div>





    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">ToggleButton CSS</h1>
        <p>
            Copy and paste the CSS to the right. These are some basic rules to style the toggle
            by its tag-name or :host context. As mentioned above, the components template, when rendered, will be wrapped by a custom tag-name derived from the ClassName as &lt;class-name&gt;. Here, &lt;toggle-button&gt;, derived from ToggleButton class.
        </p>
        <p>
            Styling the toggle-button by it's tag-name serves 2 purposes:
            <ul>
                <li><strong>Dimension:</strong> As a container for positioning, dimensions, sizing, etc..</li>
                <li><strong>Semantics:</strong> As a specificity rule for scoping -- targeting just this component</li>
            </ul>
        </p>
        <h3>Toggling Shadow DOM on/off</h3>
        <p>
            Alternatively, the :host context may be used which will allow the component to be used as a Shadow Dom element on a web page via the <code>shadow</code> attribute. Without the attribute, the component is rendered in the Light DOM as usual and probably what you're most familiar with.
            <pre class="inline html lang">
                <code>
&#x3C;toggle-button shadow&#x3E;&#x3C;/toggle-button&#x3E;
                </code>
            </pre>
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang"></div>
        <div class="css lang">
            <blockquote class="css" style="display:block;width: 100%;">
                Using the <code style="display:inline;">:host</code> context allows the component to be Shadow DOM ready
            </blockquote>
            <pre class="highlight css" style="display:block;width: 100%;">
                <code id="ns-code-block">
:host {
    width: 70px;
    height: 30px;
    display: block;
    background: lightgray;
    border-radius: 30px;
    box-sizing: content-box;
    padding: 3px;
    perspective: 3000px;
}

:host .knob {
    transition: all .2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    width: 30px;
    background: white;
    box-sizing: border-box;
    height: 100%;
    border-radius: 50%;
}
                </code>
            </pre>


            <blockquote class="css" style="display:block;width: 100%;">
                Otherwise, the components tag-name can be used if not using Shadow
                DOM.
            </blockquote>
            <pre class="highlight css" style="display:block;width: 100%;">
                <code id="ns-code-block">
toggle-button {
    width: 70px;
    height: 30px;
    display: block;
    background: lightgray;
    border-radius: 30px;
    box-sizing: content-box;
    padding: 3px;
    perspective: 3000px;
}

toggle-button .knob {
    transition: all .2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    width: 30px;
    background: white;
    box-sizing: border-box;
    height: 100%;
    border-radius: 50%;
}
                </code>
            </pre>



            <blockquote class="css" style="display:block;width: 100%;">
                Finally, the recommended approach is to style by the components <strong>.ClassName</strong> context:
            </blockquote>
            <pre class="highlight css" style="display:block;width: 100%;">
                <code id="ns-code-block">
.ToggleButton {
    width: 70px;
    height: 30px;
    display: block;
    background: lightgray;
    border-radius: 30px;
    box-sizing: content-box;
    padding: 3px;
    perspective: 3000px;
}

.ToggleButton .knob {
    transition: all .2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    width: 30px;
    background: white;
    box-sizing: border-box;
    height: 100%;
    border-radius: 50%;
}
                </code>
            </pre>
        </div>
      </div>
    </div>






    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Basic State</h1>
        <p>
            We'll need a reference to the <code>.knob</code> and the initial direction
            in the off position. 
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
async onConnected(){
    await super.onConnected();

    this.knob = this.querySelector(".knob");
    this.direction = -1;
}
                </code>
            </pre>
        </div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>





    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Listeners</h1>
        <p>
            A standard call to <code>addEventListener()</code> is wired during
            the <code>onConnected()</code> phase to execute <code>onClick()</code>
            when clicks are detected anywhere on the toggles UI.
        </p>
        <p>
            <pre class="inline javascript lang">
                <code>
this.addEventListener("click", e => this.onClick(e), false);
                </code>
            </pre>
        </p>
        <p>
            <code>onClick()</code> simply inverts the direction each time by multiplying the
            current direction by -1 to set the new direction, let's visualize the math:
            <table>
                <thead>
                <tr>
                  <th>current <code>this.direction</code></th>
                  <th>onClick multiplies by <code>-1</code></th>
                  <th>new <code>this.direction</code></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>-1 (starting state)</td>
                  <th>-1</th>
                  <td>1</td>
                </tr>
                <tr>
                  <td>1</td>
                  <th>-1</th>
                  <td>-1</td>
                </tr>
                <tr>
                  <td>-1</td>
                  <th>-1</th>
                  <td>1</td>
                </tr>
                <tr>
                  <td>1</td>
                  <th>-1</th>
                  <td>-1</td>
                </tr>
                <tr>
                  <td colspan="3">And so on between -1 and 1</td>
                </tr>
              </tbody>
            </table>
        </p>
        <p>
            <code>onRender</code> is called right after, which uses a standard css transform to 
            move the .knob on the x-axis from 0 to the width of the toggle, minus the knob width.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
async onConnected(){
    await super.onConnected();

    this.knob = this.querySelector(".knob");
    this.direction = -1;
    this.addEventListener("click", e => this.onClick(e));
}
                </code>
            </pre>

            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
onClick(){
    this.direction *= -1;
    this.onRender();
}
                </code>
            </pre>
        </div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>




    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">ToggleButton Full Source (js,html,css)</h1>
        <p>
            Alright, to the right under the respective tabs are the final source
            that you maay copy + paste into the files of your ToggleButton folder.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <blockquote class="javascript" style="display:block;width: 100%;">
                An advanced (but not necessary) use of <code style="display:inline;">DOMMatrix</code> to handle
                dynamic resizing of the component. i.e: Altering its width using css
                or javascript while the app is running.
            </blockquote>
            <pre class="highlight javascript" style="display:block;width: 100%;">
                <code id="ns-code-block">
namespace \`core.ui\` (
    class ToggleButton  extends w3c.ui.WebComponent  {
        async onConnected(){
            await super.onConnected();

            this.knob = this.querySelector(".knob");
            this.direction = -1;
            this.addEventListener("click", e => this.onClick(e));
        }

        async onStyleComputed(style){
            await wait(100);
            this.bounds = this.getBoundingClientRect();
            this.knob_bounds = this.knob.getBoundingClientRect();
        }

        onClick(){
            this.direction *= -1;
            this.onRender();
        }

        get x() {
            var offset=6;
            return this.direction > 0 ?
                this.bounds.width - this.knob_bounds.width - offset : 0;
        }

        onRender(){
            var vector = {x: this.x, y:0, z:0 }
            this.knob.style.transform = \`
                translate3d(\${vector.x||0}px,\${vector.y||0}px,\${vector.z}px)
            \`;
        }
    }
);
                </code>
            </pre>
            <blockquote class="javascript" style="display:block;width: 100%;">
                The <code style="display:inline;">onClick()</code> will rock the direction to 0 or 1 on each click by simple multiplication to -1 which inverts the sign to +/-.
            </blockquote>
        </div>
        <div class="html lang">
            <blockquote class="html" style="display:block;width: 100%;">
                What our toggle needs is a Knob to indicate direction (on | off) and serve as an element to press or tap on. All we need is a simple &#x3C;div&#x3E; that will be styled into a circular shape using CSS.
            </blockquote>
            <pre class="highlight html" style="display:block;width: 100%;">
                <code id="ns-code-block">
&#x3C;template&#x3E;
    &#x3C;div class=&#x22;knob&#x22;&#x3E;&#x3C;/div&#x3E;
&#x3C;/template&#x3E;
                </code>
            </pre>
        </div>
        <div class="css lang">
            <blockquote class="css" style="display:block;width: 100%;">
                What our toggle needs is a Knob to indicate direction (on | off) and serve as an element to press or tap on. All we need is a simple &#x3C;div&#x3E; that will be styled into a circular shape using CSS.
            </blockquote>
            <pre class="highlight css" style="display:block;width: 100%;">
                <code id="ns-code-block">
:host {
    width: 70px;
    height: 30px;
    display: block;
    background: lightgray;
    border-radius: 30px;
    box-sizing: content-box;
    padding: 3px;
    perspective: 3000px;
}

:host .knob {
    transition: all .2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    width: 30px;
    background: white;
    box-sizing: border-box;
    height: 100%;
    border-radius: 50%;
}
                </code>
            </pre>
        </div>
      </div>
    </div>





    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Using the ToggleButton inline</h1>
        <p>
            There are 2 ways to use the toggle-button, which are covered in-depth
            in the chapter, <a href="#docs.topics.ComponentUsage">Using Components</a>. But, the
            simplest way for now is to use it declaratively in HTML markup, inside the body
            of our hello-world.html:
        </p>
        <p>
            <pre class="inline html lang">
                <code>
&#x3C;body namespace=&#x22;applications.HelloWorld&#x22;&#x3E;
    &#x3C;toggle-button&#x3E;&#x3C;/toggle-button&#x3E;
&#x3C;/body&#x3E;
                </code>
            </pre>
        </p>
        <p>
            Here, our hello-world.html web page declares the toggle-button inline just
            like any other tag. But for this to work, the ToggleButton class must be
            imported by the HelloWorld application (see HTML and JavaScript tab on right).
        </p>
        <p>
          <strong>Demo:</strong><br/>
          <toggle-button></toggle-button>
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
            <blockquote class="javascript" style="display:block;width: 100%;">
            Import ToggleButton so it is available throughout the application and other
            components that rely on it.
          </blockquote>
          <pre class="highlight javascript" style="display:block;width: 100%;"><code>
import 'core.ui.ToggleButton';

namespace \`applications\` (
    class HelloWorld extends Application { 
        
    }
);
        </code></pre>
        </div>
        <div class="html lang">
            <blockquote class="html" style="display:block;width: 100%;">
            <b>hello-world.html</b>
          </blockquote>
          <pre class="highlight html" style="display:block;width: 100%;"><code>
&#x3C;!DOCTYPE html&#x3E;
&#x3C;html lang=&#x22;en&#x22;&#x3E;
    &#x3C;head&#x3E;
        &#x3C;title&#x3E;Hello World&#x3C;/title&#x3E;
        &#x3C;script src=&#x22;node_modules/od-cocoon/framework.src.js&#x22; charset=&#x22;utf-8&#x22;&#x3E;&#x3C;/script&#x3E;
    &#x3C;/head&#x3E;

    &#x3C;body namespace="applications.HelloWorld"&#x3E;
        &#x3C;hello-world&#x3E;
            &#x3C;toggle-button&#x3E;&#x3C;/toggle-button&#x3E;
        &#x3C;/hello-world&#x3E;
    &#x3C;/body&#x3E;
&#x3C;/html&#x3E;
        </code></pre>
        </div>
        <div class="css lang"></div>
      </div>
    </div>






    

  </div>
</template>