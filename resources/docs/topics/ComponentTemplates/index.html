<template>
  <div>

    
    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Introduction</h1>
        <p>
          All components, screens and world applications have 3 assets, an index.html, index.css and an index.js.
          The index.html asset is the content template belonging to a component or screen. It is only a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/template" ttargett="_new">fragment
          of HTML</a> wrapped in a <code>&#x3C;template&#x3E;</code>. As Mozilla explains:
        </p>
        <p class="sidenote">
            "The HTML Content Template (<code>&#x3C;template&#x3E;</code>) element is a mechanism for holding HTML that is <b>not to be rendered immediately when a page is loaded</b> but may be instantiated subsequently during runtime using JavaScript.
              <br/><br/>
            Think of a template as a content fragment that is being stored for subsequent use in the document. While the parser does process the contents of the <code>&#x3C;template&#x3E;</code> element while loading the page, it does so only to ensure that those contents are valid; the element's contents are not rendered, however."
        </p>
        <p>
          Here's an example template, defined perhaps for a game world, stored at the relevant namespaced world folder as index.html, 1
          of the 3 core asset files.
          <pre class="inline html lang">
            <code class="hljs">
&#x3C;template&#x3E;
    &#x3C;div&#x3E;
        &#x3C;canvas id=&#x22;stage&#x22;&#x3E;&#x3C;/canvas&#x3E;
        &#x3C;div id=&#x22;hud-layer&#x22;&#x3E;
            &#x3C;div id=&#x22;hp&#x22;&#x3E;&#x3C;/div&#x3E;
            &#x3C;div id=&#x22;mp&#x22;&#x3E;&#x3C;/div&#x3E;
            &#x3C;div id=&#x22;local-mini-map&#x22;&#x3E;
                &#x3C;local-map&#x3E;&#x3C;/local-map&#x3E;&#x3C;!--uses it's own template--&#x3E;
            &#x3C;/div&#x3E;
        &#x3C;/div&#x3E;
    &#x3C;/div&#x3E;
&#x3C;/template&#x3E;
            </code>
          </pre>
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang">
        	<blockquote class="html" style="display:block;width: 100%;">
            <b>Figure 1: The <code>&#x3C;template&#x3E;</code> used in the <span style="color:yellow;">sat-collision.html</span> example</b><br/>
            Whether component, screen, or world display, the index.html asset is always a fragment of
            HTML wrapped in a template. <em style="color:red;">Never embed typical HTML DOCTYPE markup, as you would for a webpage (See shell example below, figure 2)</em>.
          </blockquote>
          <pre class="highlight html" style="display:block;width: 100%;">
            <code>
&#x3C;template&#x3E; 
    &#x3C;div&#x3E;
        &#x3C;div&#x3E;
            &#x3C;div&#x3E;&#x3C;b&#x3E;W, S&#x3C;/b&#x3E; - Accelerate/Decelerate&#x3C;/div&#x3E;
            &#x3C;div&#x3E;&#x3C;b&#x3E;A, D&#x3C;/b&#x3E; - Turn&#x3C;/div&#x3E;
            &#x3C;div&#x3E;
                &#x3C;label&#x3E;
                    &#x3C;input id=&#x22;bvh&#x22; type=&#x22;checkbox&#x22;/&#x3E; Show Bounding Volume Hierarchy
                &#x3C;/label&#x3E;
            &#x3C;/div&#x3E;
            &#x3C;canvas id=&#x22;canvas1&#x22; width=&#x22;800&#x22; height=&#x22;600&#x22;&#x3E;&#x3C;/canvas&#x3E;
        &#x3C;/div&#x3E;
    &#x3C;/div&#x3E;
&#x3C;/template&#x3E;
            </code>
          </pre>


          <blockquote class="html" style="display:block;width: 100%;">
            <b>Figure 2: A webpage shell, at root of the project, embedded with a screen or world.</b>
            <br/>
            The <span style="color:yellow;">sat-collision.html</span> webpage example is an empty shell for embedding a world or screen.
            It's UI is defined by the screen or world <code>&#x3C;template&#x3E;</code> being loaded.
          </blockquote>
          <pre class="highlight html" style="display:block;width: 100%;">
            <code>
&#x3C;!DOCTYPE html&#x3E;
&#x3C;html lang=&#x22;en&#x22;&#x3E;
    &#x3C;head&#x3E;
        &#x3C;meta http-equiv=&#x22;Content-Type&#x22; content=&#x22;text/html; charset=utf-8&#x22;&#x3E;
        &#x3C;meta http-equiv=&#x22;Content-Security-Policy&#x22; content=&#x22;
            default-src &#x27;self&#x27; * blob: data: gap: https://ssl.gstatic.com &#x27;unsafe-eval&#x27;; 
            script-src  &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27; blob: data: *; 
            style-src   &#x27;self&#x27; &#x27;unsafe-inline&#x27; *&#x22;&#x3E;
        &#x3C;meta name=&#x22;viewport&#x22; content=&#x22;width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, target-densityDpi=device-dpi user-scalable=no&#x22;&#x3E;
        &#x3C;meta http-equiv=&#x22;X-UA-Compatible&#x22; content=&#x22;IE=edge,chrome=1&#x22;&#x3E;
        &#x3C;meta name=&#x22;apple-mobile-web-app-capable&#x22; content=&#x22;yes&#x22;&#x3E;
        &#x3C;title&#x3E;Separating Access Theorem&#x3C;/title&#x3E;
        &#x3C;script src=&#x22;node_modules/od-cocoon/framework.src.js&#x22; charset=&#x22;utf-8&#x22;&#x3E;&#x3C;/script&#x3E;
    &#x3C;/head&#x3E;

    &#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;
        &#x3C;sat-collision&#x3E;&#x3C;/sat-collision&#x3E;
    &#x3C;/body&#x3E;
&#x3C;/html&#x3E;
            </code>
          </pre>
      <blockquote class="html" style="display:block;width: 100%;">
            <b>To embed a UI within a shell:</b><br/>
            <ol>
              <li>
                Specify the FQNS <code>namespace</code> to the screen or world:<br/>
                <code>&#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;</code>
              </li>
              <li>
                Use it's HTML5 tag to render<br/>
                <code>&#x3C;sat-collision&#x3E;&#x3C;/sat-collision&#x3E;</code>
              </li>
            </ol>
          </blockquote>
        </div>
        <div class="css lang"></div>
      </div>
    </div>



    


    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">...not to be rendered immediately</h1>
        <p>
          As the mozilla docs state, a template is not to be rendered immediately but may be
          instantiated subsequently during runtime. When you finally embed and use the HTML5
          tag (figure 2 html) representing the screen/world, rendering is triggered immediately by Arc
          during <code>onConnected</code> time.
          It is interesting to know what does happen to the final HTML body after render.
        </p>
        <h3>What happens during render</h3>
        <p>
          The template is first loaded, processed by Arc, then the fragment handed to the browsers native HTML5 
          engine which ultimately validates the templates content and uses it as innerHTML at runtime. 90% of the
          process is handled natively by the DOM, not Arc.
        </p>
        <h3>The final outerHTML of body</h3>
        <p>
          After render, use the DevTools inspector  to have a look at the body. The innerHTML of all
          custom components (screens/worlds & components) are fully populated for any custom-tags in the DOM tree.
          Here's what the body should look like for the sat-collision.html example:
          <pre class="inline html lang">
            <code class="hljs">
&#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;
    &#x3C;sat-collision class=&#x22; WebComponent Application World SatCollision&#x22; namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E; 
      &#x3C;div&#x3E;
          &#x3C;div&#x3E;
              &#x3C;div&#x3E;&#x3C;b&#x3E;W, S&#x3C;/b&#x3E; - Accelerate/Decelerate&#x3C;/div&#x3E;
              &#x3C;div&#x3E;&#x3C;b&#x3E;A, D&#x3C;/b&#x3E; - Turn&#x3C;/div&#x3E;
              &#x3C;div&#x3E;
                  &#x3C;label&#x3E;
                      &#x3C;input id=&#x22;bvh&#x22; type=&#x22;checkbox&#x22;&#x3E; Show Bounding Volume Hierarchy
                  &#x3C;/label&#x3E;
              &#x3C;/div&#x3E;
              &#x3C;canvas id=&#x22;canvas1&#x22; width=&#x22;800&#x22; height=&#x22;600&#x22;&#x3E;&#x3C;/canvas&#x3E;
          &#x3C;/div&#x3E;
      &#x3C;/div&#x3E;
    &#x3C;/sat-collision&#x3E;
&#x3C;/body&#x3E;
            </code>
          </pre>
        </p>

      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang">
          <blockquote class="html" style="display:block;width: 100%;">
            <b>Figure 3: invoke <code>super.onConnected()</code> to render immediately</b>
            <br/>
            It is worth noting that unless you call <code>super.onConnected()</code>, rendering
            does not occur immediately.
          </blockquote>
          <pre class="highlight javascript" style="display:block;width: 100%;">
            <code>
import 'src/system/game/sat/Collisions.js';

namespace \`display.worlds\` (
    class SatCollision extends core.ui.World {
        constructor(element){
            super(element);
            document.addEventListener('keydown', e=>this.onKeyInput(e));
            document.addEventListener('keyup',   e=>this.onKeyInput(e));
        }

        async onConnected() {
            await super.onConnected();
            //commented for brevity
        }
    }
)
            </code>
          </pre>
          <blockquote class="html" style="display:block;width: 100%;">
            <b>Figure 4: Alternatively, you may invoke <code>await this.render()</code> at a later time</b>
            <br/>
            <code>await this.render()</code> is essentially what <code>super.onConnected()</code> does
            internally. If you need to delay rendering, you may call this method when needed.
          </blockquote>
          <pre class="highlight javascript" style="display:block;width: 100%;">
            <code>
async onConnected() {
    await wait(2000);//wait 2 seconds, maybe a db call(?)
    await this.render();
}
            </code>
          </pre>
        </div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>



    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Inline <code style="font-size: 20px !important;">&#x3C;template&#x3E;</code></h1>
        <p>
          The W3C/HTML5 specs allows a custom component to be declared at design time with an inline <code>&#x3C;template&#x3E;</code>, see
          <a href="#docs.topics.TemplateSpecificity">Template Specificity</a>.<br/>
          <em>This allows developers the flexibility to reuse components and declare custom layouts</em> in many different ways and
          not rely on the default <code>&#x3C;template&#x3E;</code> packaged by the creator.
          In addition, load time and rendering speed is cut drastically as Arc does not have to download the 
          default template asset file (index.html) at runtime, but hands over the inline template instantly to the DOM.
          <br/><br/>
          Note the inline <code>&#x3C;template&#x3E;</code> tag:
          <pre class="inline html lang">
            <code class="hljs">
&#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;
    &#x3C;sat-collision&#x3E;
        &#x3C;template&#x3E; 
            &#x3C;div&#x3E;
                &#x3C;div&#x3E;
                    &#x3C;div&#x3E;&#x3C;b&#x3E;W, S&#x3C;/b&#x3E; - Accelerate/Decelerate&#x3C;/div&#x3E;
                    &#x3C;div&#x3E;&#x3C;b&#x3E;A, D&#x3C;/b&#x3E; - Turn&#x3C;/div&#x3E;
                    &#x3C;div&#x3E;
                        &#x3C;label&#x3E;
                            &#x3C;input id=&#x22;bvh&#x22; type=&#x22;checkbox&#x22;/&#x3E; Show Bounding Volume Hierarchy
                        &#x3C;/label&#x3E;
                    &#x3C;/div&#x3E;
                    &#x3C;canvas id=&#x22;canvas1&#x22; width=&#x22;800&#x22; height=&#x22;600&#x22;&#x3E;&#x3C;/canvas&#x3E;
                &#x3C;/div&#x3E;
            &#x3C;/div&#x3E;
        &#x3C;/template&#x3E;
    &#x3C;/sat-collision&#x3E;
&#x3C;/body&#x3E;
            </code>
          </pre>
        </p>
        <p>
          Again, at runtime after having invoked <code>super.onConnected()</code> or <code>this.render()</code>, only
          the <code>&#x3C;template&#x3E;</code> content is extrapolated and used as the final <code>innerHTML</code>. Using DevTools to inspect will not
          show a <code>&#x3C;template&#x3E;</code> tag anywhere in the DOM, only the contents of that <code>&#x3C;template&#x3E;</code>:
          <pre class="inline html lang">
            <code class="hljs">
&#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;
    &#x3C;sat-collision class=&#x22; WebComponent Application World SatCollision&#x22; namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E; 
      &#x3C;div&#x3E;
          &#x3C;div&#x3E;
              &#x3C;div&#x3E;&#x3C;b&#x3E;W, S&#x3C;/b&#x3E; - Accelerate/Decelerate&#x3C;/div&#x3E;
              &#x3C;div&#x3E;&#x3C;b&#x3E;A, D&#x3C;/b&#x3E; - Turn&#x3C;/div&#x3E;
              &#x3C;div&#x3E;
                  &#x3C;label&#x3E;
                      &#x3C;input id=&#x22;bvh&#x22; type=&#x22;checkbox&#x22;&#x3E; Show Bounding Volume Hierarchy
                  &#x3C;/label&#x3E;
              &#x3C;/div&#x3E;
              &#x3C;canvas id=&#x22;canvas1&#x22; width=&#x22;800&#x22; height=&#x22;600&#x22;&#x3E;&#x3C;/canvas&#x3E;
          &#x3C;/div&#x3E;
      &#x3C;/div&#x3E;
    &#x3C;/sat-collision&#x3E;
&#x3C;/body&#x3E;
            </code>
          </pre>
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>






    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Custom tags and their <code style="font-size: 20px !important;">&#x3C;classList&#x3E;</code></h1>
        <p>
          After custom component tags are rendered, you'll notice additional attributtes, mainly, <code>class</code>
          and <code>namespace</code> are given values.

          <pre class="inline html lang">
            <code class="hljs">
&#x3C;body namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E;
    &#x3C;sat-collision class=&#x22; WebComponent Application World SatCollision&#x22; namespace=&#x22;display.worlds.SatCollision&#x22;&#x3E; 
      ...
    &#x3C;/sat-collision&#x3E;
&#x3C;/body&#x3E;
            </code>
          </pre>
        </p>
        <p>
          The &#x3C;sat-collision&#x3E; tag will have it's <code>namespace</code> attribute set by Arc pointing to it's fully-qualified namespace only as a convenience during debugging or DOM inspection. In addition, it's <code>class</code> attributte will be a list of all JavaScript <code>class{}</code> ancestors that this class inherits from. I'll say that in another way, the <code>class</code> attribute shows all of the super classes that this class (<code>display.worlds.SatCollision</code>) is a sub-class of.
        </p>
        <p>
          <em>It should be read backwards, like this:</em><br/>
          <code>SatCollision</code> extends <code>World</code>, which extends <code>Application</code>, which extends <code>WebComponent</code>. Ultimately, the <code>instanceof</code> operator reveals that, <code>SatCollision</code> is a true instance of all ancestors up until <code>WebComponent</code>. <em><code>SatCollision</code> is a <code>WebComponent</code></em>.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>




    <div style="display: flex;flex-direction: row;flex-wrap: nowrap;">
      <div style="width: 50%;padding: 22px;">
        <h1 id="api-reference">Next..</h1>
        <p>
          Now that you understand how templates work, continue to explore <a href="#docs.topics.TemplateSpecificity">Template Specificity</a> an important topic covering further flexibility and how Arc determines the order of specificity in choosing to load/not-load templates as well as "design-time" vs. run-time template declaration.
        </p>
      </div>
      <div style="width: 50%;display: block;">
        <div class="shell lang"></div>
        <div class="javascript lang"></div>
        <div class="html lang"></div>
        <div class="css lang"></div>
      </div>
    </div>



  </div>
</template>